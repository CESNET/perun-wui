<!DOCTYPE html>
<html>
<head>

	<!-- Charset -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">

	<!-- Mobile device support -->
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Default GWT locale	-->
	<meta id="meta-lang" name="gwt:property" content="locale=en">

	<!-- FavIcons -->
	<link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwDvz5cAzwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAv8+XAL/PlwAgz5cAn8+XABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAIAAAAADPlwBQz5cAEM+XAL8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAIDPlwBQz5cAIM+XAK8AAAAAz5cAgM+XADDPlwBQz5cAEAAAAADPlwCAz5cAjwAAAAAAAAAAAAAAAAAAAADPlwBgz5cAn8+XABDPlwBQz5cAEM+XADDPlwAwz5cAIM+XAL/PlwAQz5cA78+XAP8AAAAAAAAAAAAAAAAAAAAAAAAAAM+XABDPlwBwAAAAAM+XABDPlwBAz5cAIAAAAADPlwAwz5cAj8+XADDPlwAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XADDPlwCvz5cAgM+XAJ/PlwCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwAgAAAAAAAAAAAAAAAAz5cAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAGDPlwAgAAAAAM+XABDPlwBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwAQz5cAn8+XAL/PlwCvz5cAMM+XACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XABDPlwCfAAAAAAAAAAAAAAAAAAAAAM+XABDPlwAwz5cAjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAM/PlwDfz5cAEM+XAEDPlwAwz5cAYAAAAADPlwCAAAAAAM+XAFDPlwD/z5cAYAAAAAAAAAAAAAAAAAAAAADPlwDvz5cAvwAAAADPlwDvAAAAAM+XAIAAAAAAz5cAcM+XAGAAAAAAz5cAgM+XABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAIAAAAADPlwCvz5cAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cA78+XAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/P8AAPwfmhT6P5kUwhMAAMADAADkQ/+/+D8AAPu/AAD//wAA+T8AAPgf///nj///wKP//8qT///6f////n///w==" type="image/x-icon">
	<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwDvz5cAzwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAv8+XAL/PlwAgz5cAn8+XABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAIAAAAADPlwBQz5cAEM+XAL8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAIDPlwBQz5cAIM+XAK8AAAAAz5cAgM+XADDPlwBQz5cAEAAAAADPlwCAz5cAjwAAAAAAAAAAAAAAAAAAAADPlwBgz5cAn8+XABDPlwBQz5cAEM+XADDPlwAwz5cAIM+XAL/PlwAQz5cA78+XAP8AAAAAAAAAAAAAAAAAAAAAAAAAAM+XABDPlwBwAAAAAM+XABDPlwBAz5cAIAAAAADPlwAwz5cAj8+XADDPlwAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XADDPlwCvz5cAgM+XAJ/PlwCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwAgAAAAAAAAAAAAAAAAz5cAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAGDPlwAgAAAAAM+XABDPlwBwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADPlwAQz5cAn8+XAL/PlwCvz5cAMM+XACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XABDPlwCfAAAAAAAAAAAAAAAAAAAAAM+XABDPlwAwz5cAjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM+XAM/PlwDfz5cAEM+XAEDPlwAwz5cAYAAAAADPlwCAAAAAAM+XAFDPlwD/z5cAYAAAAAAAAAAAAAAAAAAAAADPlwDvz5cAvwAAAADPlwDvAAAAAM+XAIAAAAAAz5cAcM+XAGAAAAAAz5cAgM+XABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cAIAAAAADPlwCvz5cAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAz5cA78+XAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/P8AAPwfmhT6P5kUwhMAAMADAADkQ/+/+D8AAPu/AAD//wAA+T8AAPgf///nj///wKP//8qT///6f////n///w==" type="image/x-icon">

	<!-- Title -->
	<title>Perun Password Reset</title>

	<!-- Static resources -->
	<script src="./static/jquery-1.12.4.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" ></script>
	<link href="./static/bootstrap.min.css" rel="stylesheet" integrity="sha256-0aR8WoN1mQJYXL4Eo9zoE+VafSZEKO/5C7flVi2HFSQ= sha512-aANNxkx5fovm15oWBCqmaUBCsqRzuwae+5T8s/UvwoYku77uSUBnk7fIaijHNIOxX3Z4qxKLgP/hPwp5/POSlQ==" >
	<script src="./static/bootstrap.min.js" integrity="sha256-07L2YLQ0uPLEwYet/g8LarTr/92Z2iMuaQARIxHWZ5g= sha512-EuYCw1FhoKYT5MdBRdgcfCTXL9jHlBwik9hPRgPhjIvf7Lqc/UO3uHVbCKX+40rhGnBword8i3o6iBp0i1OHWA==" ></script>
	<link href="./static/font-awesome.min.css" rel="stylesheet" integrity="sha256-roYBgWmjeOsmYMKlcnmZ+/wS+eJ11bVnnKVOoO8IkPQ= sha384-dNpIIXE8U05kAbPhy3G1cz+yZmTzA6CY8Vg/u2L9xRnHjJiAK76m2BIEaSEV+/aU sha512-yXD4uNp46x5o45emA8tif5bzX9zXSMdSHiP6SBpD8B1ufUSeT7ogBn3EJQ41woJOkAqkMWVYUufuhF2U4z/Eqg==" >

	<!--  RPC definition -->
	<script type="text/javascript" language="javascript" >

		RPC_SERVER = window.location.pathname.split("/")[1];

		// get URL param function
		function getURLParameter(name) {
			return decodeURI(
				(RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,'default'])[1]
			);
		}

		var l_lang;
		l_lang = getURLParameter('locale');

		// if no locale set in URL
		if (l_lang === 'default') {

			if (typeof(Storage) !== "undefined") {

				l_lang = localStorage.getItem("urn:perun:gui:preferences:language")

			}

			// if not set, set from browser settings
			if (l_lang == null) {

				if (navigator.userLanguage) // Explorer
					l_lang = navigator.userLanguage.split("-")[0];
				else if (navigator.language) // FF
					l_lang = navigator.language;
				else
					l_lang = "en";

			}

		}

		var ele = document.getElementById("meta-lang");
		ele.setAttribute('content', 'locale='+l_lang);

		// determine version of IE
		function getIEVersion() {
			var sAgent = window.navigator.userAgent;
			var Idx = sAgent.indexOf("MSIE");

			// If IE, return version number.
			if (Idx > 0)
				return parseInt(sAgent.substring(Idx+ 5, sAgent.indexOf(".", Idx)));

			// If IE 11 then look for Updated user agent string.
			else if (!!navigator.userAgent.match(/Trident\/7\./))
				return 11;

			else
				return 0; //It is not IE
		}

		// Skip on Chrome 1+, Firefox 3.5+, IE 8+, Opera 10+, Safari 3.2
		if (getIEVersion() !== 0 && getIEVersion() < 10) {
			// Is IE < 10
			alert("Unsupported browser. Please use either: Internet Explorer 10+ or Edge, Firefox, Chrome, Opera 15+ or Safari");
		}
		var isOperaBefore15 = (window.opera && navigator.userAgent.indexOf(' OPR/') === -1);
		if (isOperaBefore15) {
			alert("Unsupported browser. Please use either: Internet Explorer 10+ or Edge, Firefox, Chrome, Opera 15+ or Safari");
		}

		$(document).ready(function() {
			// Methods which check if the Perun connection is OK, run only on startup
			executeQuery();
		});

		function reloadMsg() {

			if (l_lang === "en" || l_lang === "default") {
				alert("Data connection lost. Server is probably being restarted or URL \"/"+RPC_SERVER+"/rpc/\" is not valid. Click OK to reload the page.");
			} else if (l_lang === "cs") {
				alert("Aplikace ztratila spojení. Server se pravděpodobně právě restartuje nebo URL \"/"+RPC_SERVER+"/rpc/\" není platná. Klikněte na OK pro obnovení stránky.");
			} else {
				alert("Data connection lost. Server is probably being restarted or URL \"/"+RPC_SERVER+"/rpc/\" is not valid. Click OK to reload the page.");
			}

			window.location.reload(true);
		}

		function executeQuery() {
			$.ajax({
				url: "/"+RPC_SERVER+"/rpc/",
				success: function(data) {
					if (!(data.indexOf("OK!") === 0)) {
						reloadMsg();
					}
				},
				statusCode: {
					404: function() {
						reloadMsg();
					},
					401: function() {
						reloadMsg();
					},
					302: function() {
						window.location.reload(true);
					},
					0: function() {
						window.location.reload(true);
					}
				},
				error: function(jqXHR, textStatus, errorThrown) {
					if (jqXHR.status === 0) {
						window.location.reload(true);
					} else if (jqXHR.status === 302) {
						window.location.reload(true);
					} else {
						reloadMsg();
					}
				}
			});
		}

	</script>

	<!-- Load GWT GUI -->
	<script type="text/javascript" language="javascript" src="./PerunPwdReset/PerunPwdReset.nocache.js"></script>

	<style type="text/css" >

		/* Sticky footer */
		body {
			height: 100vh; /* Not use min-height because of IE 10/11 bug */
			display: flex;
			flex-direction: column;
		}
		body > * {
			flex-shrink: 0; /* because items used to shrink when content is too long */
		}
		#app-content {
			flex: 1 0 auto;
		}

		#perun-footer {
			margin-top: 3em;
			background-color: #f8f8f8;
			border-top: 1px solid #e7e7e7;
		}
		#perun-credits {
			padding-top: 1em;
			padding-bottom: 1em;
		}
		@media(min-width:992px) {
			#perun-credits {
				text-align: right;
			}
		}
		#perun-help {
			padding-top: 1em;
			padding-bottom: 1em;
		}

	</style>

</head>
<body>

<!-- OPTIONAL: include this if you want history support -->
<iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1'
		style="position: absolute; width: 0; height: 0; border: 0"></iframe>

<!-- RECOMMENDED if your web app will not function without JavaScript enabled -->
<noscript>
	<div style="width: 22em; position: absolute; left: 50%; margin-left: -11em; color: red; background-color: white; border: 1px solid red; padding: 4px; font-family: sans-serif">
		Your web browser must have JavaScript enabled in order for this
		application to display correctly.</div>
</noscript>

<div id="app-content">
	<!-- Div we include our webapp too -->
</div>

<div id="perun-footer">
	<div class="container">
		<div class="row">
			<div id="perun-help" class="col col-md-6 col-lg-6 col-sm-6 col-xs-12"></div>
			<div style="padding-top: 1em; padding-bottom: 1em;" class="col col-md-6 col-lg-6 col-sm-6 col-xs-12">
				<p>© Copyright: CESNET, CERIT-SC ; Operated by: MU, EGI</p>
			</div>
		</div>
	</div>
</div>

</body>
</html>
